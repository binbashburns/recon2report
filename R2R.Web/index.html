<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>recon2report</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div id="app">
        <header>
            <h1>recon2report ⓡ②ⓡ</h1>
            <p class="tagline">Better pentesting, from recon to reporting</p>
            <nav>
                <a href="#" onclick="goToScreen('session-form')">Home</a>
                <a href="#" onclick="goToScreen('hosts')">Hosts</a>
                <a href="#" onclick="goToScreen('reference')">Attack Vector Reference</a>
            </nav>
        </header>

        <main id="main-content">
            <!-- Screen 1: Session + Target Form -->
            <section id="session-form" class="screen active">
                <h2>Create Session & Target</h2>
                <form id="create-session-form">
                    <div class="form-group">
                        <label for="session-name">Session Name</label>
                        <input type="text" id="session-name" placeholder="e.g., htb-lab" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="target-ip">Target IP</label>
                        <input type="text" id="target-ip" placeholder="e.g., 192.168.1.10" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="target-os">Target OS</label>
                        <select id="target-os" required>
                            <option value="">Select OS</option>
                            <option value="windows">Windows</option>
                            <option value="linux">Linux</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Create Session</button>
                </form>
            </section>

            <!-- Screen 2: Nmap Suggestions -->
            <section id="nmap-suggestions" class="screen">
                <h2>Nmap Scan Suggestions</h2>
                <p class="hint">Choose a scan strategy based on your time and needs</p>
                <div id="nmap-commands-list"></div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="goToScreen('session-form')">Back</button>
                    <button type="button" class="btn btn-primary" onclick="goToScreen('nmap-paste')">Paste Results</button>
                </div>
            </section>

            <!-- Screen 3: Paste Nmap -->
            <section id="nmap-paste" class="screen">
                <h2>Paste Nmap XML Output</h2>
                <p class="hint">Run your Nmap scan with <code>-oX</code> flag and paste the XML output below</p>
                <form id="nmap-form">
                    <div class="form-group">
                        <textarea id="nmap-xml" rows="15" placeholder="Paste Nmap XML output here..." required></textarea>
                    </div>
                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" onclick="goToScreen('nmap-suggestions')">Back</button>
                        <button type="submit" class="btn btn-primary">Parse Scan</button>
                    </div>
                </form>
            </section>

            <!-- Screen 4: Parsed Ports -->
            <section id="parsed-ports" class="screen">
                <nav class="sub-nav">
                    <a href="#" class="active" onclick="goToScreen('parsed-ports')">Detected Ports & Services</a>
                    <a href="#" onclick="goToScreen('hosts')">Host Info</a>
                    <a href="#" onclick="goToScreen('suggestions')">Attack Vectors</a>
                </nav>
                <h2>Detected Ports & Services</h2>
                <div id="ports-list"></div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="goToScreen('nmap-paste')">Back</button>
                </div>
            </section>

            <!-- Screen 5: Suggestions / Next Steps -->
            <section id="suggestions" class="screen">
                <nav class="sub-nav">
                    <a href="#" onclick="goToScreen('parsed-ports')">Detected Ports & Services</a>
                    <a href="#" onclick="goToScreen('hosts')">Host Info</a>
                    <a href="#" class="active" onclick="goToScreen('suggestions')">Attack Vectors</a>
                </nav>
                <h2>Attack Path Suggestions</h2>
                <p id="target-host-display" class="hint" style="display: none;"></p>
                <div class="phase-selector">
                    <label for="phase-select">Current Phase:</label>
                    <select id="phase-select" onchange="updatePhase()">
                        <option value="reconnaissance">Reconnaissance</option>
                        <option value="credential_access">Credential Access</option>
                        <option value="lateral_movement">Lateral Movement</option>
                        <option value="privilege_escalation">Privilege Escalation</option>
                        <option value="persistence">Persistence</option>
                    </select>
                </div>
                <div id="suggestions-list"></div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="goToScreen('parsed-ports')">Back</button>
                    <button type="button" class="btn btn-primary" onclick="goToScreen('session-form')">New Session</button>
                </div>
            </section>

            <!-- Screen 6: Hosts Management -->
            <section id="hosts" class="screen">
                <nav class="sub-nav">
                    <a href="#" onclick="goToScreen('parsed-ports')">Detected Ports & Services</a>
                    <a href="#" class="active" onclick="goToScreen('hosts')">Host Info</a>
                    <a href="#" onclick="goToScreen('suggestions')">Attack Vectors</a>
                </nav>
                <h2>Host Information</h2>
                <p class="hint">View and update information for discovered hosts</p>
                
                <!-- Host Selector -->
                <div class="form-group">
                    <label for="host-select">Select Host:</label>
                    <select id="host-select" onchange="loadHostInfo()">
                        <option value="">-- Select a host --</option>
                    </select>
                </div>
                
                <div id="host-info-container" style="display: none;">
                    <div class="host-info-section">
                        <h3>Basic Information</h3>
                        <div class="info-grid">
                            <div class="form-group">
                                <label for="host-ip">IP Address:</label>
                                <input type="text" id="host-ip" readonly>
                            </div>
                            
                            <div class="form-group">
                                <label for="host-hostname">Hostname:</label>
                                <input type="text" id="host-hostname" readonly>
                            </div>
                            
                            <div class="form-group">
                                <label for="host-os">Operating System:</label>
                                <input type="text" id="host-os" placeholder="e.g., Windows Server 2019, Ubuntu 20.04">
                            </div>
                            
                            <div class="form-group">
                                <label for="host-ports-count">Open Ports:</label>
                                <input type="text" id="host-ports-count" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="host-info-section">
                        <h3>Credentials & Access</h3>
                        <div class="info-grid">
                            <div class="form-group">
                                <label for="host-username">Username(s):</label>
                                <textarea id="host-username" rows="2" placeholder="e.g., administrator, john.doe"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="host-password">Password(s):</label>
                                <textarea id="host-password" rows="2" placeholder="e.g., P@ssw0rd123"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="host-domain">Domain:</label>
                                <input type="text" id="host-domain" placeholder="e.g., CORP.LOCAL">
                            </div>
                            
                            <div class="form-group">
                                <label for="host-hash">Hash(es):</label>
                                <textarea id="host-hash" rows="2" placeholder="e.g., NTLM hashes"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="host-info-section">
                        <h3>Additional Notes</h3>
                        <div class="form-group">
                            <label for="host-notes">Notes:</label>
                            <textarea id="host-notes" rows="4" placeholder="Any other relevant information..."></textarea>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button type="button" class="btn btn-primary" onclick="saveHostInfo()">Save Changes</button>
                        <button type="button" class="btn btn-secondary" onclick="goToScreen('session-form')">Back to Home</button>
                    </div>
                </div>
                
                <div id="no-hosts-available" class="empty-state">
                    <h3>No hosts available</h3>
                    <p>Scan some hosts first to manage their information</p>
                    <button type="button" class="btn btn-primary" onclick="goToScreen('session-form')">Create Session</button>
                </div>
            </section>

            <!-- Screen 7: Attack Vector Reference / Dictionary -->
            <section id="reference" class="screen">
                <h2>All Attacks</h2>
                <p class="hint">Complete catalog of all attack vectors by phase (commands show placeholder syntax)</p>
                <div class="phase-selector">
                    <label for="reference-phase-select">Phase:</label>
                    <select id="reference-phase-select" onchange="loadReferenceVectors()">
                        <option value="reconnaissance">Reconnaissance</option>
                        <option value="credential_access">Credential Access</option>
                        <option value="lateral_movement">Lateral Movement</option>
                        <option value="privilege_escalation">Privilege Escalation</option>
                        <option value="persistence">Persistence</option>
                    </select>
                </div>
                <div id="reference-list"></div>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" onclick="goToScreen('session-form')">Back to Home</button>
                </div>
            </section>
        </main>

        <div id="status" class="status"></div>
    </div>

    <script type="module" src="/main.js"></script>
</body>
</html>
